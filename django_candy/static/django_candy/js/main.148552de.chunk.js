(this.webpackJsonpcandy=this.webpackJsonpcandy||[]).push([[0],{81:function(e,t,s){},82:function(e,t,s){"use strict";s.r(t);var n,a=s(0),r=s(1),o=s.n(r),c=s(20),i=s.n(c),l=s(2),d=s(3),h=s(4),u=s(6),j=s(5),p=s(7),b=s(10),m=s(18),O=s.n(m);n=window.candy.base_api_url||"/candy/api/v1/";O.a.defaults.withCredentials=!0;var f=function(){function e(t){if(Object(d.a)(this,e),this.endpoint=n+t+"/",document.cookie.split(";").filter((function(e){return 0===e.trim().indexOf("csrftoken=")})).length){var s=document.cookie.split(";").filter((function(e){return 0===e.trim().indexOf("csrftoken=")}))[0].split("=")[1];s&&(O.a.defaults.headers.common["X-CSRFTOKEN"]=s)}}return Object(h.a)(e,[{key:"createEntity",value:function(e,t){var s=this;return new Promise((function(n,a){O.a.post(s.endpoint+"?"+t,e).then((function(e){n(e)})).catch((function(e){a(e)}))}))}},{key:"deleteEntity",value:function(e,t){return O.a.delete(this.endpoint+e+"/?"+t)}},{key:"updateEntity",value:function(e,t,s){return O.a.patch(this.endpoint+e+"/?"+s,t)}},{key:"getList",value:function(e){return void 0===e&&(e=""),O.a.get(this.endpoint+"?"+e)}},{key:"getOne",value:function(e,t){var s=this;return void 0===t&&(t=""),new Promise((function(n,a){O.a.get(s.endpoint+e+"/?"+t).then((function(e){n(e)})).catch((function(e){a(e)}))}))}},{key:"post",value:function(e,t){return O.a.post(e,t)}}]),e}(),v={home:"/:base_url/",app_index:"/:base_url/:app_label/",model_list:"/:base_url/:app_label/:model_name/",model_add:"/:base_url/:app_label/:model_name/add/",model_edit:"/:base_url/:app_label/:model_name/:id(\\d+)/edit/"},x=s(14),g=s(42),y=s(40);function k(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}function w(){for(var e=[],t=0;t<arguments.length;t++){var s=t<0||arguments.length<=t?void 0:arguments[t];s.length>1&&s.endsWith("/")&&(s=s.substr(0,s.length-1)),t>0&&s.startsWith("/")&&(s=s.substr(1,s.length)),"/"==s&&(s=""),e.push(s)}var n=e.join("/");return n.endsWith("/")||(n+="/"),n}var C={};function N(e,t){var s=C[e],n="";if("undefined"===typeof s){if(e.indexOf("?")>-1){var a=e.split("?"),r=Object(g.a)(a,2);e=r[0],n=r[1]}s=Object(y.a)(e),C[e]=s}var o=s(t);return n?o+"?"+n:o}function _(e){var t=e.args,s=Object(x.a)(e,["args"]);return s.to=N(s.to,t),Object(a.jsx)(b.b,Object(l.a)(Object(l.a)({},s),{},{children:s.children}))}function S(e){var t=e.args,s=Object(x.a)(e,["args"]);return s.to=N(s.to,t),Object(a.jsx)(b.c,Object(l.a)(Object(l.a)({},s),{},{children:s.children}))}function T(e){var t="bi bi-"+e.name;return e.className&&(t=t+" "+e.className),Object(a.jsx)("i",{className:t})}var L=s(19),R=s(9);function E(e){var t=e.className,s=Object(x.a)(e,["className"]);return t||(t=""),Object(a.jsx)("div",Object(l.a)({className:"loader circle "+t},s))}var D=o.a.forwardRef((function(e,t){var s;e.loading&&(s=Object(a.jsx)(E,{}));var n="btn "+e.className;return Object(a.jsxs)("button",{className:n,type:e.type||"button",disabled:!(!e.loading&&!e.disabled),onClick:e.onClick,ref:t,children:[e.children,s]})})),P=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).handleClickOutside=function(e){n.container.current&&!n.container.current.contains(e.target)&&n.state.shown&&n.setState({shown:!1})},n.state={selected:e.selectedIndex||0,shown:!1,selectedOnce:!1},n.getBtnClass=n.getBtnClass.bind(Object(R.a)(n)),n.toggleMenu=n.toggleMenu.bind(Object(R.a)(n)),n.container=o.a.createRef(),n}return Object(h.a)(s,[{key:"getBtnClass",value:function(){var e=this.state.shown?" dropup":" dropdown";return"btn "+this.props.className+e}},{key:"toggleMenu",value:function(){this.setState({shown:!this.state.shown})}},{key:"onOptionClick",value:function(e,t){!1===this.props.autoChange?this.setState({shown:!1}):this.setState({selectedOnce:!0,selected:t,shown:!1}),this.props.onChange&&this.props.onChange(e,t)}},{key:"componentDidUpdate",value:function(e,t){this.props.selectedIndex!==e.selectedIndex&&this.state.selected!==this.props.selectedIndex&&this.setState({selected:this.props.selectedIndex})}},{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this,t=this.props.placement||"",s=null;return this.state.shown&&(s=Object(a.jsx)("div",{className:this.state.shown?"dropdown-menu show "+t:"dropdown-menu "+t,children:this.props.options.map((function(t,s){return Object(a.jsx)("button",{type:"button",className:e.state.selected===s?"dropdown-item active":"dropdown-item",onClick:t.onSelect?t.onSelect:function(n){return e.onOptionClick(t,s)},children:t.label},s)}))},"menu")),Object(a.jsxs)("div",{className:this.state.shown?"dropdown-container show":"dropdown-container",ref:this.container,children:[Object(a.jsxs)("button",{className:this.getBtnClass(),type:"button",onClick:this.toggleMenu,children:[this.props.icon," ",this.state.selectedOnce?this.props.options[this.state.selected].selectLabel:this.props.children]}),Object(a.jsx)(L.CSSTransitionGroup,{transitionName:"dropdown-menu",transitionEnterTimeout:100,transitionLeaveTimeout:100,children:s})]})}}]),s}(o.a.Component);var U=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).toggleNav=function(e){n.setState({open:!n.state.open}),document.body.classList.toggle("nav-open")},n.handleLinkClick=function(e){n.state.open&&n.toggleNav()},n.state={open:!1},n}return Object(h.a)(s,[{key:"componentDidUpdate",value:function(e,t){this.props.instance!==e.instance&&this.state.open&&(this.setState({open:!1}),document.body.classList.remove("nav-open"))}},{key:"componentWillUnmount",value:function(){document.body.classList.remove("nav-open")}},{key:"render",value:function(){var e=this,t=this.props.match.params.base_url;return Object(a.jsxs)("div",{children:[Object(a.jsx)(L.CSSTransitionGroup,{transitionName:"overlay",transitionEnterTimeout:100,transitionLeaveTimeout:150,children:this.state.open&&Object(a.jsx)("div",{className:"overlay",onClick:this.handleLinkClick},"overlay")||null}),Object(a.jsxs)("div",{className:"nav top-nav",children:[Object(a.jsxs)(_,{to:v.home,args:{base_url:t},className:"logo",children:[Object(a.jsx)("img",{src:"/static/django_candy/img/logo-nav.png",alt:window.candy.site_name,className:"d-none d-sm-block"}),Object(a.jsx)("img",{src:"/static/django_candy/img/logo-nav-mobile.png",alt:window.candy.site_name,className:"d-block d-sm-none"})]})," "," ",Object(a.jsx)("button",{className:"toggle-nav d-md-none",onClick:this.toggleNav,children:this.state.open?Object(a.jsx)(T,{name:"x"}):Object(a.jsx)(T,{name:"list"})}),Object(a.jsx)("ul",{className:"d-none d-md-block",children:Object(a.jsx)("li",{children:Object(a.jsxs)(P,{className:"default",placement:"right",selectedIndex:-1,options:[{label:"Logout",onSelect:this.props.handleLogout}],children:[Object(a.jsx)(T,{name:"person",className:"nav-user-icon"})," ",this.props.user.name]})})})]}),Object(a.jsx)("div",{className:this.state.open?"nav side-nav open":"nav side-nav",id:this.props.id,children:Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)(S,{exact:!0,to:v.home,args:{base_url:t},onClick:this.handleLinkClick,children:"Home"})},"home"),this.props.sideMenu.map((function(s){return[Object(a.jsx)("li",{children:Object(a.jsx)("span",{className:"menu-header",children:k(s.verbose_name)})},s.app_label),s.models.map((function(n){return Object(a.jsx)("li",{children:Object(a.jsx)(S,{to:v.model_list,args:{base_url:t,app_label:s.app_label,model_name:n.name.toLowerCase()},onClick:e.handleLinkClick,children:k(n.menu_label)})},n.app_label+"."+n.name)}))]}))]})})]})}}]),s}(r.Component);function F(e){return Object(a.jsx)("div",{className:"nav sub-nav",children:Object(a.jsx)("ul",{children:r.Children.map(e.children,(function(e){return e?Object(a.jsx)("li",{children:e}):null}))})})}function A(e){var t=e.title,s=e.location.pathname,n=null,r=new URLSearchParams(e.location.search).get("_list_filters")||"";return Object(p.e)(s,e.edit_url)?t+=" / Edit":Object(p.e)(s,e.add_url)&&(t+=" / Add New"),(Object(p.e)(s,e.edit_url)||Object(p.e)(s,e.add_url))&&(n=Object(a.jsxs)(_,{to:e.list_url+r,args:{base_url:e.match.params.base_url,app_label:e.match.params.app_label,model_name:e.match.params.model_name},children:[Object(a.jsx)(T,{name:"arrow-left"})," View All"]})),document.title=e.title+" | "+window.candy.site_name,Object(a.jsx)("div",{className:"header",children:Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("div",{className:"col-12 col-md-5",children:Object(a.jsx)("h3",{children:t})}),Object(a.jsx)("div",{className:"col-12 col-md-7",children:!e.hideSubnav&&Object(a.jsxs)(F,{children:[n,e.permissions.can_add?Object(a.jsxs)(_,{className:"active",to:e.add_url,args:{base_url:e.match.params.base_url,app_label:e.match.params.app_label,model_name:e.match.params.model_name},children:[Object(a.jsx)(T,{name:"plus"})," Add New"]}):null,Object(a.jsxs)("button",{className:"btn",onClick:e.onRefresh,children:[Object(a.jsx)(T,{name:"arrow-clockwise"})," Refresh"]})]})})]})})}function I(e){var t=e.label,s=e.helpText,n=e.error,r=e.required,o=e.inputRef,c=Object(x.a)(e,["label","helpText","error","required","inputRef"]),i="";s&&(i=Object(a.jsx)("span",{className:"help-text",children:s}));var d="";return n&&(d=Object(a.jsx)("span",{className:"help-text",children:n})),c.className||(c.className="form-control"),o&&(c.ref=o),Object(a.jsxs)("div",{className:n?"form-group error":"form-group",children:[t?Object(a.jsxs)("label",{children:[t," ",r&&Object(a.jsx)("span",{className:"required-label",children:"*"})]}):null,Object(a.jsx)("input",Object(l.a)({},c)),d,i]})}r.Component;function M(e){var t=e.label,s=Object(x.a)(e,["label"]);return Object(a.jsx)("div",{className:"custom-control custom-"+s.type,children:Object(a.jsxs)("label",{className:"custom-control-label",children:[t,Object(a.jsx)("input",Object(l.a)({className:"custom-control-input"},s)),Object(a.jsx)("div",{className:"custom-control-indicator"})]})})}r.Component;r.Component;function W(e){var t=Object(a.jsx)("th",{className:"checkbox-col",children:Object(a.jsx)(M,{type:"checkbox",checked:e.checked,onChange:e.onCheckChange,disabled:!e.isCheckable})}),s=e.thWidths||[];return Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[t,e.th.map((function(e,t){var n=s[t],r=n?"thcol-"+n:null;return Object(a.jsx)("th",{className:r,children:e},e)})),e.hasActions?Object(a.jsx)("th",{className:s.length>e.th.length&&"thcol-"+s[e.th.length],children:"Actions"},"actions"):null]})})}function q(e){var t=Object(a.jsx)("td",{className:"checkbox-col",children:Object(a.jsx)(M,{type:"checkbox",checked:e.checked,onChange:e.onCheckChange,disabled:!e.isCheckable})});return Object(a.jsxs)("tr",{className:e.flash?"flash":null,children:[t,e.children]})}var B=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).getTableRowURI=function(){var e=window.location.search;return e.length?n.props.tableRowURI+"?_list_filters="+encodeURIComponent(e):n.props.tableRowURI},n.renderForMobile=function(){var e=!!n.props.tableRowActions,t=n.props.tableColCls||[],s=n.props.data.map((function(s){for(var r=[],o=0;o<n.props.tableCols.length;o++){var c="col_"+o+"_"+s.id,i=n.props.tableTh[o],l=s[n.props.tableCols[o]];"boolean"===typeof l&&(l=l?Object(a.jsx)(T,{name:"check-circle",className:"table-col-icon text-success"}):Object(a.jsx)(T,{name:"x-circle",className:"table-col-icon text-error"}));var d=t[o];d||(d=0===o?"col-12":"col-6"),r.push(Object(a.jsxs)("div",{className:d,children:[Object(a.jsx)("span",{className:"col-label",children:i}),Object(a.jsx)("span",{className:0===o?"item-title":"",children:l})]},c))}var h=null;return e&&(h=Object(a.jsx)("div",{className:"col-12 actions-col",children:n.props.tableRowActions(s)})),n.props.tableRowURI?Object(a.jsx)("div",{children:Object(a.jsxs)(_,{to:n.getTableRowURI(),args:{id:s.id},className:"table-item-card",children:[Object(a.jsx)("div",{className:"row",children:r}),Object(a.jsx)("div",{className:"caret",children:Object(a.jsx)(T,{name:"chevron-right"})})]})},s.id):Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"table-item-card",children:Object(a.jsxs)("div",{className:"row",children:[r,h]})})},s.id)}));return Object(a.jsx)("div",{children:s})},n.state={headChecked:!1,rowsChecked:[]},n.handleHeadCheck=n.handleHeadCheck.bind(Object(R.a)(n)),n.handleRowCheck=n.handleRowCheck.bind(Object(R.a)(n)),n}return Object(h.a)(s,[{key:"handleHeadCheck",value:function(e){var t=[];!0===e.target.checked&&(t=this.props.data.map((function(e){return e.id}))),this.props.tableCheckCallback(t),this.setState({headChecked:e.target.checked,rowsChecked:[]})}},{key:"handleRowCheck",value:function(e,t){var s=this.state.rowsChecked;if(e.target.checked)s.push(t),this.setState({rowsChecked:s});else{var n=s.indexOf(t);if(n>-1)s.splice(n,1),this.setState({rowsChecked:s});else if(this.state.headChecked){for(var a=0;a<this.props.data.length;a++){var r=this.props.data[a].id;r!==t&&s.push(r)}this.setState({rowsChecked:s,headChecked:!1})}}this.props.tableCheckCallback(s)}},{key:"render",value:function(){var e,t=this,s=window.innerWidth<576;if(this.props.data.length<1)return Object(a.jsx)("div",{className:"well",children:Object(a.jsx)("h1",{children:"Nothing here"})});if(s)return this.renderForMobile();var n=!!this.props.tableRowActions,r=!!this.props.tableCheckable;this.props.tableTh&&(e=Object(a.jsx)(W,{th:this.props.tableTh,checked:this.state.headChecked,onCheckChange:this.handleHeadCheck,hasActions:n,isCheckable:r,thWidths:this.props.tableThWidths}));for(var o=this.props.flashRows||[],c=[],i=function(e){for(var s=t.props.data[e],i=[],l=0;l<t.props.tableCols.length;l++){var d="col_"+l+"_"+s.id;if(t.props.tableRowURI&&0===l)i.push(Object(a.jsx)("td",{children:Object(a.jsx)(_,{to:t.getTableRowURI(),args:{id:s.id},children:s[t.props.tableCols[l]]})},d));else{var h=s[t.props.tableCols[l]];"boolean"===typeof h&&(h=h?Object(a.jsx)(T,{name:"check-circle",className:"table-col-icon text-success"}):Object(a.jsx)(T,{name:"x-circle",className:"table-col-icon text-error"})),i.push(Object(a.jsx)("td",{children:h},d))}}var u=null;n&&(u=Object(a.jsx)("td",{children:t.props.tableRowActions(s)})),c.push(Object(a.jsxs)(q,{checked:t.state.headChecked||t.state.rowsChecked.indexOf(s.id)>-1,onCheckChange:function(e){return t.handleRowCheck(e,s.id)},isCheckable:r,flash:o.includes(e),children:[i,u]},s.id))},l=0;l<this.props.data.length;l++)i(l);return Object(a.jsxs)("table",{children:[e,Object(a.jsx)("tbody",{children:c})]})}}]),s}(r.Component),G=s(21),H=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).toolbarToolsRef=o.a.createRef(),n}return Object(h.a)(s,[{key:"render",value:function(){return Object(a.jsxs)("div",{className:"toolbar",children:[Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("div",{className:"col-12 col-md-4",children:Object(a.jsx)(V,{})}),Object(a.jsx)("div",{className:"col-12 col-md-8 text-right toolbar-buttons",children:Object(a.jsx)(X,{toolsRef:this.toolbarToolsRef,filters:this.props.filters})})]}),Object(a.jsx)("div",{ref:this.toolbarToolsRef})]})}}]),s}(r.Component),Q=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).handleSearchChange=function(e){n.setState({searchVal:e.target.value})},n.handleSubmit=function(e){e.preventDefault(),n.updateSearch()},n.updateSearch=function(){var e=n.state.searchVal,t=new URLSearchParams(n.props.location.search);""===e?t.delete("q"):t.set("q",e),t.delete("page"),n.setState({activeQuery:e}),n.props.history.push(n.props.location.pathname+"?"+t.toString())},n.clearSearch=function(e){n.setState({searchVal:"",activeQuery:""},(function(){return n.updateSearch()}))},n.handleFocus=function(e){n.setState({focussed:!0}),n.input.current.focus()},n.handleBlur=function(e){n.setState({focussed:!1}),n.input.current.blur()},n.state={searchVal:"",activeQuery:"",focussed:!1},n.input=o.a.createRef(),n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search).get("q")||"";""!==e&&this.setState({searchVal:e,activeQuery:e})}},{key:"render",value:function(){var e=null;return""===this.state.activeQuery&&null!==this.state.activeQuery||(e=Object(a.jsxs)("p",{children:[Object(a.jsx)("br",{}),"Search results for: ",Object(a.jsxs)("strong",{children:['"',this.state.activeQuery,'"']})," ",Object(a.jsxs)("button",{className:"btn link",onClick:this.clearSearch,children:[Object(a.jsx)(T,{name:"x-circle"})," Clear"]})]})),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("form",{onSubmit:this.handleSubmit,children:Object(a.jsxs)("div",{className:"input-group",children:[Object(a.jsx)("div",{className:"input-group-prepend",children:Object(a.jsx)("span",{className:this.state.focussed?"input-group-text focussed":"input-group-text",onClick:this.handleFocus,children:Object(a.jsx)(T,{name:"search"})})}),Object(a.jsx)("input",{type:"text",name:"q",className:"form-control icon-prepend",placeholder:"Search...",autoFocus:this.state.focussed,onFocus:this.handleFocus,onBlur:this.handleBlur,ref:this.input,value:this.state.searchVal,onChange:this.handleSearchChange})]})}),e]})}}]),s}(r.Component),V=Object(p.f)(Q),z=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).getFilterBtnClass=function(){return"btn "+(n.props.filterApplied?"primary":"default")+" "+(n.props.toolsShown?"dropup":"dropdown")},n}return Object(h.a)(s,[{key:"render",value:function(){var e;return this.props.filterApplied&&(e=Object(a.jsxs)("button",{className:"btn default",onClick:this.props.clearFilters,children:[Object(a.jsx)(T,{name:"x-circle"})," Clear"]})),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("button",{className:this.getFilterBtnClass(),onClick:this.props.toggleFilterTools,children:[Object(a.jsx)(T,{name:"sliders"})," Filters ",this.props.filterApplied?"Applied":null]}),e]})}}]),s}(r.Component),J=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(d.a)(this,s),t.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){return this.props.toolsRef.current&&this.props.isShown?i.a.createPortal(this.props.children,this.props.toolsRef.current):null}}]),s}(r.Component),K=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).getFilterState=function(){for(var e=new URLSearchParams(n.props.location.search),t={},s=0;s<n.props.filters.length;s++){var a=n.props.filters[s];"radio"===a.type?t[a.name]=e.get(a.name):"checkbox"===a.type&&(t[a.name]=e.getAll(a.name))}return t},n.handleSubmit=function(e){e.preventDefault();var t=new URLSearchParams(n.props.location.search);n.props.filters.map((function(e){return t.delete(e.name),null}));var s,a=new FormData(e.target),r=Object(G.a)(a);try{for(r.s();!(s=r.n()).done;){var o=s.value;t.append(o[0],o[1])}}catch(c){r.e(c)}finally{r.f()}t.delete("page"),(t="?"+t.toString())!==n.props.location.search&&n.props.history.push(n.props.location.pathname+t),n.setState({showTools:!1})},n.toggleFilterTools=function(){n.setState({showTools:!n.state.showTools})},n.clearFilters=function(){var e=new URLSearchParams(n.props.location.search);n.props.filters.map((function(t){return e.has(t.name)&&e.delete(t.name),null})),n.props.history.push(n.props.location.pathname+"?"+e.toString()),n.setState({showTools:!1})},n.state={showTools:!1},n}return Object(h.a)(s,[{key:"render",value:function(){var e=this.getFilterState(),t=!1,s=null;return this.state.showTools?s=this.props.filters.map((function(s){var n=s.options.map((function(n){var r=!1;return"radio"===s.type?String(e[s.name])===n.value&&(r=!0):"checkbox"===s.type&&String(e[s.name]).includes(n.value)&&(r=!0),r&&!t&&(t=!0),Object(a.jsx)(M,{label:n.label,type:s.type,name:s.name,value:n.value,defaultChecked:t?r:n.default},s.name+"_option_"+n.value)}));return Object(a.jsxs)("div",{className:"col-12 col-md-4 col-sm-6",children:[Object(a.jsx)("h4",{children:s.label}),n]},"filter_"+s.name)})):t=this.props.filters.some((function(t){return t.options.some((function(s){if("radio"===t.type){if(e[t.name]===s.value)return!0}else if("checkbox"===t.type&&e[t.name].includes(s.value))return!0;return!1}))})),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z,{filterApplied:t,toggleFilterTools:this.toggleFilterTools,clearFilters:this.clearFilters,toolsShown:this.state.showTools}),Object(a.jsx)(L.CSSTransitionGroup,{transitionName:"toolbar-tools",transitionEnterTimeout:100,transitionLeaveTimeout:100,children:s?Object(a.jsx)(J,{toolsRef:this.props.toolsRef,isShown:this.state.showTools,children:Object(a.jsx)("div",{className:"toolbar-tools",children:Object(a.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(a.jsx)("div",{className:"row filters-row",children:s}),Object(a.jsx)("div",{className:"row filter-btns",children:Object(a.jsxs)("div",{className:"col-12",children:[Object(a.jsx)(D,{className:"primary",type:"submit",children:"Apply"})," ",Object(a.jsx)(D,{className:"default",type:"button",onClick:this.toggleFilterTools,children:"Cancel"})]})})]})})},"filterTools"):null})]})}}]),s}(r.Component),X=Object(p.f)(K),Y=new(function(){function e(){Object(d.a)(this,e),this.toasts=new Set}return Object(h.a)(e,[{key:"register",value:function(e){var t=this;return this.toasts.add(e),function(){return t.unregister(e)}}},{key:"unregister",value:function(e){var t=this;this.toasts.forEach((function(s){s===e&&t.toasts.delete(e)}))}},{key:"success",value:function(e){this.toasts.forEach((function(t){t.showToast(e,"success")}))}},{key:"error",value:function(e){this.toasts.forEach((function(t){t.showToast(e,"error")}))}},{key:"showLoader",value:function(){this.toasts.forEach((function(e){e.showLoaderToast()}))}},{key:"hideLoader",value:function(){this.toasts.forEach((function(e){e.hideLoaderToast()}))}},{key:"showConnectionError",value:function(e){this.toasts.forEach((function(t){t.showConnectionError(e)}))}},{key:"hideConnectionError",value:function(){}},{key:"hideAll",value:function(){this.toasts.forEach((function(e){e.hideAll()}))}},{key:"hideError",value:function(){this.toasts.forEach((function(e){e.hideError()}))}}]),e}()),Z=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).timer=null,n.toastService=Y,n.state={message:null,type:null,loader:!1,connectionError:!1,retryCallback:null},n.showToast=n.showToast.bind(Object(R.a)(n)),n.showLoaderToast=n.showLoaderToast.bind(Object(R.a)(n)),n.hideLoaderToast=n.hideLoaderToast.bind(Object(R.a)(n)),n.hasToast=n.hasToast.bind(Object(R.a)(n)),n.unregister=n.toastService.register(Object(R.a)(n)),n.closeToast=n.closeToast.bind(Object(R.a)(n)),n.closeConnectionErrorToast=n.closeConnectionErrorToast.bind(Object(R.a)(n)),n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.unregister()}},{key:"showToast",value:function(e,t){clearTimeout(this.timer),this.setState({message:e,type:t,loader:!1,connectionError:!1,retryCallback:null}),"success"===t&&(this.timer=setTimeout(this.closeToast,5e3))}},{key:"showLoaderToast",value:function(){this.setState({loader:!0,connectionError:!1,retryCallback:null})}},{key:"hideLoaderToast",value:function(){this.setState({loader:!1})}},{key:"showConnectionError",value:function(e){this.setState({loader:!1,message:null,type:null,connectionError:!0,retryCallback:e})}},{key:"hideError",value:function(){this.hasToast()&&"error"===this.state.type&&this.setState({message:null,type:null,loader:!1})}},{key:"hideAll",value:function(){this.hasToast()&&this.setState({message:null,type:null,loader:!1})}},{key:"hasToast",value:function(){return!!(this.state.loader||this.state.message||this.connectionError)}},{key:"_componentDidUpdate",value:function(){this.hasToast&&(clearTimeout(this.timer),this.timer=setTimeout(this.props.hideToast,5e3))}},{key:"closeToast",value:function(e){this.setState({message:null,type:null})}},{key:"closeConnectionErrorToast",value:function(e){this.setState({message:null,type:null,connectionError:!1})}},{key:"render",value:function(){var e=null;this.state.loader?e=Object(a.jsx)(ee,{},"loader"):this.state.connectionError&&(e=Object(a.jsx)(te,{onRetry:this.state.retryCallback,onClose:this.closeConnectionErrorToast},"connerror"));var t=null;return this.state.message&&!this.state.connectionError&&(t=Object(a.jsx)($,{message:this.state.message,type:this.state.type,onClose:this.closeToast},"toast")),Object(a.jsx)("div",{className:"toast-container",children:Object(a.jsxs)(L.CSSTransitionGroup,{transitionName:"toast-animate",transitionEnterTimeout:100,transitionLeaveTimeout:100,component:"div",className:"toast-container",children:[e,t]})})}}]),s}(r.Component);function $(e){var t="";e.type&&(t=e.type);var s=null;return"success"===t?s=Object(a.jsx)(T,{name:"check"}):"error"===t&&(s=Object(a.jsx)(T,{name:"exclamation-octagon"})),Object(a.jsxs)("div",{className:"toast "+t,children:[Object(a.jsx)("div",{className:"icon",children:s}),Object(a.jsx)("div",{className:"message",children:e.message}),Object(a.jsx)("div",{className:"close",children:Object(a.jsx)("button",{onClick:e.onClose,children:"\xd7"})})]})}function ee(){return Object(a.jsx)("div",{className:"toast loader-toast",children:Object(a.jsxs)("div",{className:"message",children:[Object(a.jsx)(E,{})," Loading"]})})}function te(e){return Object(a.jsxs)("div",{className:"toast error",children:[Object(a.jsx)("div",{className:"icon with-btn",children:Object(a.jsx)(T,{name:"exclamation-octagon"})}),Object(a.jsxs)("div",{className:"message",children:["Check your internet connection."," ",Object(a.jsx)("button",{className:"btn link",onClick:e.onRetry,children:"Try again"})]}),Object(a.jsx)("div",{className:"close",children:Object(a.jsx)("button",{onClick:e.onClose,children:"\xd7"})})]})}function se(){return Object(a.jsx)("div",{className:"placeholder ph-input"})}function ne(){return Object(a.jsx)("div",{className:"placeholder ph-button"})}function ae(){return Object(a.jsxs)("div",{className:"skeleton-table table-container",children:[Object(a.jsxs)("div",{className:"row header",children:[Object(a.jsx)("div",{className:"col-md-4 col-12",children:Object(a.jsx)(se,{})}),Object(a.jsx)("div",{className:"col-md-8 col-12 text-right d-none d-md-block",children:Object(a.jsx)(ne,{})}),Object(a.jsx)("div",{className:"col-md-8 col-12 d-md-none",children:Object(a.jsx)(ne,{})})]}),[1,2,3,4,5,6,7,8,9].map((function(e){return Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("div",{className:"col-md-1 col-12 d-none d-md-block",children:Object(a.jsx)("div",{className:"placeholder ph-checkbox"})}),Object(a.jsx)("div",{className:"col-md-6 col-12 d-none d-md-block",children:Object(a.jsx)("div",{className:"placeholder ph-line"})}),Object(a.jsx)("div",{className:"col-md-2 col-12",children:Object(a.jsx)("div",{className:"placeholder ph-line"})}),Object(a.jsx)("div",{className:"col-md-3 col-12",children:Object(a.jsx)("div",{className:"placeholder ph-line"})})]},e)}))]})}var re=Object(p.f)((function(e){var t=e.total_count,s=e.per_page,n=e.currentPage,r=Math.ceil(t/s);(n>r||n<1)&&(n=1);var o,c,i=new URLSearchParams(e.location.search);1===n?o=Object(a.jsx)("span",{children:Object(a.jsx)(T,{name:"chevron-left"})}):(i.set("page",n-1),o=Object(a.jsx)(b.b,{to:{search:i.toString()},onClick:e.onPageClick,children:Object(a.jsx)(T,{name:"chevron-left"})})),n===r||0===r?c=Object(a.jsx)("span",{children:Object(a.jsx)(T,{name:"chevron-right"})}):(i.set("page",n+1),c=Object(a.jsx)(b.b,{to:{search:i.toString()},onClick:e.onPageClick,children:Object(a.jsx)(T,{name:"chevron-right"})}));var l=[];if(r<8)for(var d=1;d<=r;d++)d===n?l.push(Object(a.jsx)("span",{className:"active",children:d},d)):(i.set("page",d),l.push(Object(a.jsx)(b.b,{to:{search:i.toString()},onClick:e.onPageClick,children:d},d)));else{var h=new Set;h.add(1),1===n?(h.add(2),h.add(3)):n===r?(h.add(r-2),h.add(r-1)):(h.add(n-1),h.add(n),h.add(n+1)),h.add(r);var u,j=Object(G.a)(h);try{for(j.s();!(u=j.n()).done;){var p=u.value;1!==p&&(h.has(p-1)||l.push(Object(a.jsx)("span",{children:"..."},p-1))),p===n?l.push(Object(a.jsx)("span",{className:"active",children:p},p)):(i.set("page",p),l.push(Object(a.jsx)(b.b,{to:{search:i.toString()},onClick:e.onPageClick,children:p},p)))}}catch(m){j.e(m)}finally{j.f()}}return Object(a.jsxs)("div",{className:"pagination",children:[o,l,c,Object(a.jsxs)("span",{children:["(Total: ",t,")"]})]})}));function oe(e){return Object(a.jsxs)("div",{className:"splash",children:[Object(a.jsx)("img",{src:"/static/django_candy/img/logo-splash.png",alt:window.candy.site_name}),Object(a.jsx)(E,{})]})}function ce(e){return Object(a.jsxs)("div",{className:"splash text-center",children:[Object(a.jsx)("img",{src:"/static/django_candy/img/error-splash.png",alt:"Error"}),Object(a.jsx)("h2",{children:e.msg||"Something went wrong. Try again"}),e.retryCallback?Object(a.jsx)("p",{children:Object(a.jsx)("button",{className:"btn link",onClick:e.retryCallback,children:e.retryBtnText||"Try Again"})}):null]})}function ie(e){return Object(a.jsxs)("div",{className:"main",children:[Object(a.jsx)(A,{hideSubnav:!0,title:"404 Page not found",location:e.location}),Object(a.jsx)("div",{className:"content",children:Object(a.jsx)("p",{className:"lead",children:"The requested page doesn't exist."})})]})}var le=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).refreshPage=function(){n.setState({refresh:!n.state.refresh})},n.state={refresh:!1},n.list_url=w(n.props.match.url,"/"),n.add_url=w(n.props.match.url,"/add/"),n.edit_url=w(n.props.match.url,"/:id/edit/"),n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e=this,t={can_add:!0},s=this.props.match.params.app_label,n=this.props.match.params.model_name;if(!this.props.initData.apps.hasOwnProperty(s))return Object(a.jsx)(ie,{location:this.props.location});var o=this.props.initData.apps[s];if(!o.models.hasOwnProperty(n))return Object(a.jsx)(ie,{location:this.props.location});var c=o.models[n];return Object(a.jsxs)("div",{className:"main",children:[Object(a.jsx)(p.a,{render:function(s){return Object(a.jsx)(A,Object(l.a)(Object(l.a)({},s),{},{title:k(c.verbose_name_plural),list_url:v.model_list,edit_url:v.model_edit,add_url:v.model_add,onRefresh:e.refreshPage,permissions:t}))}}),Object(a.jsxs)(p.c,{children:[Object(a.jsx)(p.a,{path:v.model_list,exact:!0,render:function(t){return Object(r.createElement)(de,Object(l.a)(Object(l.a)({},t),{},{model:c,key:c.endpoint,refresh:e.state.refresh}))}}),Object(a.jsx)(p.a,{path:v.model_add,exact:!0,render:function(t){return Object(a.jsx)(he,Object(l.a)(Object(l.a)({},t),{},{model:c,refresh:e.state.refresh}))}}),Object(a.jsx)(p.a,{path:v.model_edit,exact:!0,render:function(t){return Object(a.jsx)(ue,Object(l.a)(Object(l.a)({},t),{},{model:c,refresh:e.state.refresh}))}}),Object(a.jsxs)(p.a,{children:[Object(a.jsx)("p",{children:"404 Page Not Found."}),Object(a.jsx)("p",{children:"This page doesn't exist."})]})]})]})}}]),s}(r.Component),de=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).queryApi=function(){var e=new URLSearchParams(n.props.location.search),t=Number(e.get("page"))||1,s=n.state.list_limit,a=(t-1)*s;e.delete("page"),e.set("limit",s),e.set("offset",a),new f(n.api_endpoint).getList(e.toString()).then((function(e){n.setState({loading:!1,data:e.data}),window.scrollTo(0,0)})).catch((function(e){var t="CONNECTION_ERROR";e.response?t=e.response.status:e.response={},401===e.response.status?n.props.handleLogout(!0):(n.setState({loading:!1,hasError:!0,errorType:t}),Y.showConnectionError(n.retryApi))}))},n.retryApi=function(){n.setState({loading:!0,hasError:!1}),n.queryApi()},n.getCurrentPage=function(){var e=new URLSearchParams(n.props.location.search);return Number(e.get("page"))||1},n.state={data:null,loading:!0,hasError:!1,errorType:null,list_limit:20},n.api_endpoint=n.props.model.endpoint,n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){window.scrollTo(0,0),this.queryApi(),Y.showLoader()}},{key:"componentDidUpdate",value:function(e,t,s){this.props.location.search===e.location.search&&this.props.refresh===e.refresh||(this.setState({loading:!0}),this.queryApi()),this.state.loading!==t.loading&&(this.state.loading?Y.showLoader():Y.hideLoader())}},{key:"componentWillUnmount",value:function(){Y.hideLoader()}},{key:"render",value:function(){return this.state.loading?Object(a.jsx)("div",{className:"content",children:Object(a.jsx)(ae,{})}):Object(a.jsxs)("div",{className:"content",children:[Object(a.jsxs)("div",{className:"table-container",children:[Object(a.jsx)(H,{filters:this.props.model.list_filters}),Object(a.jsx)("div",{className:"table-outer",children:Object(a.jsx)(B,{data:this.state.data.results,tableCols:this.props.model.list_display,tableTh:this.props.model.list_display_labels,tableColCls:[],tableThWidths:[],tableRowURI:":id/edit/",tableRowActions:null,tableCheckable:!0,tableCheckCallback:function(){return null}})})]}),Object(a.jsx)("div",{className:"row",children:Object(a.jsx)("div",{className:"col-12",children:Object(a.jsx)(re,{total_count:this.state.data.count,per_page:this.state.list_limit,currentPage:this.getCurrentPage()})})})]})}}]),s}(r.Component);function he(e){return Object(a.jsx)("h2",{children:":TODO:"})}function ue(e){return Object(a.jsx)("h2",{children:":TODO:"})}var je=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){return Object(d.a)(this,s),t.call(this,e)}return Object(h.a)(s,[{key:"render",value:function(){var e=this,t=this.props.match.params.app_label;if(!this.props.initData.apps.hasOwnProperty(t))return Object(a.jsx)(ie,{location:this.props.location});var s=this.props.initData.apps[t];return Object(a.jsxs)("div",{className:"main",children:[Object(a.jsx)(A,{hideSubnav:!0,title:s.verbose_name,location:this.props.location}),Object(a.jsx)("div",{className:"content",children:Object.keys(s.models).map((function(n){var r=s.models[n];return Object(a.jsx)("div",{children:Object(a.jsx)(_,{to:v.model_list,args:{base_url:e.props.match.params.base_url,app_label:t,model_name:r.name},children:k(r.verbose_name_plural)})},t+"."+r.name)}))})]})}}]),s}(r.Component);function pe(e){return Object(a.jsxs)("div",{className:"main",children:[Object(a.jsx)(A,{title:"Home",hideSubnav:!0,location:e.location}),Object(a.jsx)("div",{className:"content"})]})}var be=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).handleUsernameChange=function(e){n.setState({username:e.target.value,errorUsername:""})},n.handlePasswordChange=function(e){n.setState({password:e.target.value,errorPassword:""})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.username,s=n.state.password;if(!t||!s)return t||n.setState({errorUsername:"Username is required"}),void(s||n.setState({errorPassword:"Password is required"}));n.setState({isSubmitting:!0,errorGeneral:""});var a=new f("login");a.post(a.endpoint,{username:t,password:s}).then((function(e){console.log(e.data),n.props.onLogin(e.data)})).catch((function(e){var t="Something went wrong. Please check your internet connection";e.response&&(t=401===e.response.status?"Unauthorized":"Wrong Username or Password"),n.setState({isSubmitting:!1,errorGeneral:t})}))},n.state={username:"",password:"",errorUsername:"",errorPassword:"",errorGeneral:"",isSubmitting:!1},n.year=(new Date).getFullYear(),n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){document.documentElement.classList.add("full-height")}},{key:"componentWillUnmount",value:function(){document.documentElement.classList.remove("full-height")}},{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("img",{src:"/static/django_candy/img/logo-splash.png",alt:window.candy.site_name,className:"form-signin-logo"}),Object(a.jsxs)("div",{className:"form-signin",children:[Object(a.jsx)("h2",{className:"text-center",children:"Login"}),this.state.errorGeneral?Object(a.jsx)("div",{className:"alert error",children:this.state.errorGeneral}):null,Object(a.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(a.jsx)(I,{type:"text",name:"username",placeholder:"Username",value:this.state.username,onChange:this.handleUsernameChange,label:"Username",error:this.state.errorUsername,autoCapitalize:"off"}),Object(a.jsx)(I,{type:"password",name:"password",placeholder:"Password",value:this.state.password,onChange:this.handlePasswordChange,label:"Password",error:this.state.errorPassword}),Object(a.jsx)(D,{type:"submit",className:"primary",loading:this.state.isSubmitting,children:this.state.isSubmitting?"Logging in...":"Login"})]})]}),Object(a.jsxs)("p",{className:"form-signin-bottom",children:["\xa9 ",this.year," Candy"]})]})}}]),s}(r.Component),me=(s(81),function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).getInitData=function(){new f("init").getList().then((function(e){e.data.user.authenticated?n.setState({loading:!1,initData:e.data,errorMsg:null}):(n.redirectToLogin(),n.setState({loading:!1,errorMsg:null}))})).catch((function(e){console.log(e);var t="CONNECTION_ERROR";e.response&&(t=e.response.status),401===t?n.redirectToLogin():"CONNECTION_ERROR"===t?n.setState({loading:!1,errorMsg:"Check your internet connection"}):n.setState({loading:!1,errorMsg:"Something went wrong"})}))},n.redirectToNext=function(){var e=new URLSearchParams(n.props.location.search).get("next")||"/";"/"===e&&(e=n.base_admin_url),n.props.history.push(e)},n.redirectToLogin=function(){var e=n.props.location.search;-1===n.props.location.pathname.indexOf("login")&&(e="?next="+n.props.location.pathname),n.props.history.push(n.login_url+e)},n.onLogin=function(e){n.setState({loading:!0}),n.getInitData()},n.handleLogout=function(){var e=new f("logout");e.post(e.endpoint).then((function(e){n.onLogout(!1)})).catch((function(e){e.response||(e.response={}),401===e.response.status?n.onLogout(!1):Y.error("Something went wrong.")}))},n.onLogout=function(e){n.setState({initData:n.defaultInitData},(function(){e?n.redirectToLogin():n.props.history.push(n.login_url)}))},n.retryApi=function(){n.setState({loading:!0}),n.getInitData()},n.defaultInitData={user:{authenticated:!1}},n.state={loading:!0,initData:n.defaultInitData,errorMsg:null,user:null},window.hasOwnProperty("candy")||(window.candy={site_name:"Candy",base_admin_url:"/candy/"}),n.base_admin_url=window.candy.base_admin_url,n.login_url=n.base_admin_url+"login/",n}return Object(h.a)(s,[{key:"componentDidMount",value:function(){"/"===this.props.location.pathname&&this.props.history.replace(this.base_admin_url),this.getInitData()}},{key:"componentDidUpdate",value:function(e,t){this.state.initData.user.authenticated&&this.props.location.pathname===this.login_url&&this.redirectToNext()}},{key:"render",value:function(){var e=this;return this.state.loading?Object(a.jsx)(oe,{}):this.state.errorMsg?Object(a.jsx)(ce,{msg:this.state.errorMsg,retryCallback:this.retryApi}):this.props.location.pathname.startsWith(this.base_admin_url)?this.state.initData.user.authenticated?Object(a.jsxs)("div",{className:"container-fluid",children:[Object(a.jsx)(Z,{}),Object(a.jsx)(U,{sideMenu:this.state.initData.side_menu,topMenu:this.state.initData.top_menu,location:this.props.location,match:this.props.match,history:this.props.history,user:this.state.initData.user,handleLogout:this.handleLogout}),Object(a.jsx)("div",{className:"row",children:Object(a.jsx)("div",{className:"col-12 px-0",children:Object(a.jsxs)(p.c,{children:[Object(a.jsx)(p.a,{path:v.home,exact:!0,render:function(e){return Object(a.jsx)(pe,Object(l.a)({},e))}}),Object(a.jsx)(p.a,{path:v.app_index,exact:!0,render:function(t){return Object(a.jsx)(je,Object(l.a)(Object(l.a)({},t),{},{initData:e.state.initData}))}}),Object(a.jsx)(p.a,{path:v.model_list,render:function(t){return Object(a.jsx)(le,Object(l.a)(Object(l.a)({},t),{},{initData:e.state.initData}))}}),Object(a.jsx)(p.a,{render:function(){return Object(a.jsx)("div",{className:"main",style:{marginTop:"2rem"},children:Object(a.jsx)(ce,{msg:"404: Page Not Found",retryCallback:e.redirectToNext,retryBtnText:"Go To Home"})})}})]})})})]}):Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(be,{onLogin:this.onLogin,instance:this.state.instance})}):Object(a.jsx)(ce,{msg:"404 Page not found"})}}]),s}(r.Component)),Oe=Object(p.f)(me);function fe(e){var t=e.props;return Object(a.jsxs)(b.a,{children:[Object(a.jsx)(p.a,{path:"/:base_url?",render:function(){return Object(a.jsx)(Oe,Object(l.a)({},t))}}),Object(a.jsxs)("div",{className:"footer",children:["version ","0.7.1"]})]})}var ve=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,83)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;s(e),n(e),a(e),r(e),o(e)}))};i.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(fe,{})}),document.getElementById("root")),ve()}},[[82,1,2]]]);
//# sourceMappingURL=main.148552de.chunk.js.map