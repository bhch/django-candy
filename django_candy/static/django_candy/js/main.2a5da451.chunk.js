(this.webpackJsonpcandy=this.webpackJsonpcandy||[]).push([[0],{78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a,c=n(0),s=n(1),i=n.n(s),r=n(22),l=n.n(r),o=n(2),d=n(5),h=n(6),j=n(9),b=n(8),u=n(7),p=n(3),O=n(17),m=n.n(O),v=(a=window.candy.base_api_url||"/candy/api/v1/",function(){function e(t){Object(d.a)(this,e),this.endpoint=a+t+"/"}return Object(h.a)(e,[{key:"createEntity",value:function(e,t){var n=this;return new Promise((function(a,c){m.a.post(n.endpoint+"?"+t,e).then((function(e){a(e)})).catch((function(e){c(e)}))}))}},{key:"deleteEntity",value:function(e,t){return m.a.delete(this.endpoint+e+"/?"+t)}},{key:"updateEntity",value:function(e,t,n){return m.a.patch(this.endpoint+e+"/?"+n,t)}},{key:"getList",value:function(e){return void 0===e&&(e=""),m.a.get(this.endpoint+"?"+e)}},{key:"getOne",value:function(e,t){var n=this;return void 0===t&&(t=""),new Promise((function(a,c){m.a.get(n.endpoint+e+"/?"+t).then((function(e){a(e)})).catch((function(e){c(e)}))}))}}]),e}()),x=n(13),f=n(37);function g(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}function k(){for(var e=[],t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];n.length>1&&n.endsWith("/")&&(n=n.substr(0,n.length-1)),t>0&&n.startsWith("/")&&(n=n.substr(1,n.length)),"/"==n&&(n=""),e.push(n)}var a=e.join("/");return a.endsWith("/")||(a+="/"),a}var C={};function N(e,t){var n=C[e];return"undefined"===typeof n&&(n=Object(f.a)(e),C[e]=n),n(t)}function w(e){var t=e.args,n=Object(x.a)(e,["args"]);return n.to=N(n.to,t),Object(c.jsx)(u.b,Object(o.a)(Object(o.a)({},n),{},{children:n.children}))}function _(e){var t="bi bi-"+e.name;return e.className&&(t=t+" "+e.className),Object(c.jsx)("i",{className:t})}var y=n(39),R=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).toggleNav=function(e){a.setState({open:!a.state.open}),document.body.classList.toggle("nav-open")},a.handleLinkClick=function(e){a.state.open&&a.toggleNav()},a.state={open:!1},a}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e,t){this.props.instance!==e.instance&&this.state.open&&(this.setState({open:!1}),document.body.classList.remove("nav-open"))}},{key:"componentWillUnmount",value:function(){document.body.classList.remove("nav-open")}},{key:"render",value:function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)(y.CSSTransitionGroup,{transitionName:"overlay",transitionEnterTimeout:100,transitionLeaveTimeout:150,children:this.state.open&&Object(c.jsx)("div",{className:"overlay",onClick:this.handleLinkClick},"overlay")||null}),Object(c.jsxs)("div",{className:"nav top-nav",children:[Object(c.jsxs)(u.b,{to:"/",className:"logo",children:[Object(c.jsx)("img",{src:"/static/django_candy/logo_nav.png",alt:window.candy.site_name,className:"d-none d-sm-block"}),Object(c.jsx)("img",{src:"/static/django_candy/logo_nav_mobile.png",alt:window.candy.site_name,className:"d-block d-sm-none"})]})," "," ",Object(c.jsx)("button",{className:"toggle-nav d-md-none",onClick:this.toggleNav,children:this.state.open?Object(c.jsx)(_,{name:"x"}):Object(c.jsx)(_,{name:"list"})})]}),Object(c.jsx)("div",{className:this.state.open?"nav side-nav open":"nav side-nav",id:this.props.id,children:Object(c.jsx)("ul",{children:this.props.sideMenu.map((function(e){return[Object(c.jsx)("li",{children:Object(c.jsx)("span",{className:"menu-header",children:g(e.verbose_name)})},e.app_label),e.models.map((function(e){return Object(c.jsx)("li",{children:Object(c.jsx)(u.c,{to:k("/",e.app_label,e.name.toLowerCase()),children:g(e.menu_label)})},e.app_label+"."+e.name)}))]}))})})]})}}]),n}(s.Component);function D(e){return Object(c.jsx)("div",{className:"nav sub-nav",children:Object(c.jsx)("ul",{children:s.Children.map(e.children,(function(e){return e?Object(c.jsx)("li",{children:e}):null}))})})}function S(e){var t=e.title,n=e.location.pathname,a=null,s=new URLSearchParams(e.location.search).get("_list_filters")||"";return Object(p.e)(n,e.edit_url)?(t+=" / Edit",a=Object(c.jsxs)(u.b,{to:e.list_url+s,children:[Object(c.jsx)(_,{name:"arrow-left"})," View All"]})):Object(p.e)(n,e.add_url)&&(t+=" / Add New",a=Object(c.jsxs)(u.b,{to:e.list_url+s,children:[Object(c.jsx)(_,{name:"arrow-left"})," View All"]})),document.title=e.title+" | "+window.candy.site_name,Object(c.jsx)("div",{className:"header",children:Object(c.jsxs)("div",{className:"row",children:[Object(c.jsx)("div",{className:"col-12 col-md-5",children:Object(c.jsx)("h3",{children:t})}),Object(c.jsx)("div",{className:"col-12 col-md-7",children:!e.hideSubnav&&Object(c.jsxs)(D,{children:[a,e.permissions.can_add?Object(c.jsxs)(u.b,{className:"active",to:e.add_url,children:[Object(c.jsx)(_,{name:"plus"})," Add New"]}):null,Object(c.jsxs)("button",{className:"btn",onClick:e.onRefresh,children:[Object(c.jsx)(_,{name:"arrow-clockwise"})," Refresh"]})]})})]})})}var T=n(18);function L(e){var t=e.label,n=e.helpText,a=e.error,s=e.required,i=e.inputRef,r=Object(x.a)(e,["label","helpText","error","required","inputRef"]),l="";n&&(l=Object(c.jsx)("span",{className:"help-text",children:n}));var d="";return a&&(d=Object(c.jsx)("span",{className:"help-text",children:a})),r.className||(r.className="form-control"),i&&(r.ref=i),Object(c.jsxs)("div",{className:a?"form-group error":"form-group",children:[t?Object(c.jsxs)("label",{children:[t," ",s&&Object(c.jsx)("span",{className:"required-label",children:"*"})]}):null,Object(c.jsx)("input",Object(o.a)({},r)),d,l]})}s.Component;function U(e){var t=e.label,n=Object(x.a)(e,["label"]);return Object(c.jsx)("div",{className:"custom-control custom-"+n.type,children:Object(c.jsxs)("label",{className:"custom-control-label",children:[t,Object(c.jsx)("input",Object(o.a)({className:"custom-control-input"},n)),Object(c.jsx)("div",{className:"custom-control-indicator"})]})})}s.Component;s.Component;function A(e){var t=Object(c.jsx)("th",{className:"checkbox-col",children:Object(c.jsx)(U,{type:"checkbox",checked:e.checked,onChange:e.onCheckChange,disabled:!e.isCheckable})}),n=e.thWidths||[];return Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[t,e.th.map((function(e,t){var a=n[t],s=a?"thcol-"+a:null;return Object(c.jsx)("th",{className:s,children:e},e)})),e.hasActions?Object(c.jsx)("th",{className:n.length>e.th.length&&"thcol-"+n[e.th.length],children:"Actions"},"actions"):null]})})}function I(e){var t=Object(c.jsx)("td",{className:"checkbox-col",children:Object(c.jsx)(U,{type:"checkbox",checked:e.checked,onChange:e.onCheckChange,disabled:!e.isCheckable})});return Object(c.jsxs)("tr",{className:e.flash?"flash":null,children:[t,e.children]})}var M=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).getTableRowURI=function(){var e=window.location.search;return e.length?a.props.tableRowURI+"?_list_filters="+encodeURIComponent(e):a.props.tableRowURI},a.renderForMobile=function(){var e=!!a.props.tableRowActions,t=a.props.tableColCls||[],n=a.props.data.map((function(n){for(var s=[],i=0;i<a.props.tableCols.length;i++){var r="col_"+i+"_"+n.id,l=a.props.tableTh[i],o=n[a.props.tableCols[i]];"boolean"===typeof o&&(o=o?Object(c.jsx)(_,{name:"check-circle",className:"table-col-icon text-success"}):Object(c.jsx)(_,{name:"x-circle",className:"table-col-icon text-error"}));var d=t[i];d||(d=0===i?"col-12":"col-6"),s.push(Object(c.jsxs)("div",{className:d,children:[Object(c.jsx)("span",{className:"col-label",children:l}),Object(c.jsx)("span",{className:0===i?"item-title":"",children:o})]},r))}var h=null;return e&&(h=Object(c.jsx)("div",{className:"col-12 actions-col",children:a.props.tableRowActions(n)})),a.props.tableRowURI?Object(c.jsx)("div",{children:Object(c.jsxs)(w,{to:a.getTableRowURI(),args:{id:n.id},className:"table-item-card",children:[Object(c.jsx)("div",{className:"row",children:s}),Object(c.jsx)("div",{className:"caret",children:Object(c.jsx)(_,{name:"chevron-right"})})]})},n.id):Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"table-item-card",children:Object(c.jsxs)("div",{className:"row",children:[s,h]})})},n.id)}));return Object(c.jsx)("div",{children:n})},a.state={headChecked:!1,rowsChecked:[]},a.handleHeadCheck=a.handleHeadCheck.bind(Object(T.a)(a)),a.handleRowCheck=a.handleRowCheck.bind(Object(T.a)(a)),a}return Object(h.a)(n,[{key:"handleHeadCheck",value:function(e){var t=[];!0===e.target.checked&&(t=this.props.data.map((function(e){return e.id}))),this.props.tableCheckCallback(t),this.setState({headChecked:e.target.checked,rowsChecked:[]})}},{key:"handleRowCheck",value:function(e,t){var n=this.state.rowsChecked;if(e.target.checked)n.push(t),this.setState({rowsChecked:n});else{var a=n.indexOf(t);if(a>-1)n.splice(a,1),this.setState({rowsChecked:n});else if(this.state.headChecked){for(var c=0;c<this.props.data.length;c++){var s=this.props.data[c].id;s!==t&&n.push(s)}this.setState({rowsChecked:n,headChecked:!1})}}this.props.tableCheckCallback(n)}},{key:"render",value:function(){var e,t=this,n=window.innerWidth<576;if(this.props.data.length<1)return Object(c.jsx)("div",{className:"well",children:Object(c.jsx)("h1",{children:"Nothing here"})});if(n)return this.renderForMobile();var a=!!this.props.tableRowActions,s=!!this.props.tableCheckable;this.props.tableTh&&(e=Object(c.jsx)(A,{th:this.props.tableTh,checked:this.state.headChecked,onCheckChange:this.handleHeadCheck,hasActions:a,isCheckable:s,thWidths:this.props.tableThWidths}));for(var i=this.props.flashRows||[],r=[],l=function(e){for(var n=t.props.data[e],l=[],o=0;o<t.props.tableCols.length;o++){var d="col_"+o+"_"+n.id;if(t.props.tableRowURI&&0===o)l.push(Object(c.jsx)("td",{children:Object(c.jsx)(w,{to:t.getTableRowURI(),args:{id:n.id},children:n[t.props.tableCols[o]]})},d));else{var h=n[t.props.tableCols[o]];"boolean"===typeof h&&(h=h?Object(c.jsx)(_,{name:"check-circle",className:"table-col-icon text-success"}):Object(c.jsx)(_,{name:"x-circle",className:"table-col-icon text-error"})),l.push(Object(c.jsx)("td",{children:h},d))}}var j=null;a&&(j=Object(c.jsx)("td",{children:t.props.tableRowActions(n)})),r.push(Object(c.jsxs)(I,{checked:t.state.headChecked||t.state.rowsChecked.indexOf(n.id)>-1,onCheckChange:function(e){return t.handleRowCheck(e,n.id)},isCheckable:s,flash:i.includes(e),children:[l,j]},n.id))},o=0;o<this.props.data.length;o++)l(o);return Object(c.jsxs)("table",{children:[e,Object(c.jsx)("tbody",{children:r})]})}}]),n}(s.Component);function P(e){return Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(S,{hideSubnav:!0,title:"404 Page not found",location:e.location}),Object(c.jsx)("div",{className:"content",children:Object(c.jsx)("p",{className:"lead",children:"The requested page doesn't exist."})})]})}var W=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).list_url=k(a.props.match.url,"/"),a.add_url=k(a.props.match.url,"/add/"),a.edit_url=k(a.props.match.url,"/:id/edit/"),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e=this,t={can_add:!0},n=this.props.match.params.app_label,a=this.props.match.params.model;if(!this.props.initData.apps.hasOwnProperty(n))return Object(c.jsx)(P,{location:this.props.location});var i=this.props.initData.apps[n];if(!i.models.hasOwnProperty(a))return Object(c.jsx)(P,{location:this.props.location});var r=i.models[a];return Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(p.a,{render:function(n){return Object(c.jsx)(S,Object(o.a)(Object(o.a)({},n),{},{title:g(r.verbose_name_plural),list_url:e.list_url,edit_url:e.edit_url,add_url:e.add_url,onRefresh:e.refreshPage,permissions:t}))}}),Object(c.jsxs)(p.c,{children:[Object(c.jsx)(p.a,{path:this.props.match.path,exact:!0,render:function(e){return Object(s.createElement)(E,Object(o.a)(Object(o.a)({},e),{},{model:r,key:r.endpoint}))}}),Object(c.jsx)(p.a,{path:k(this.props.match.path,"/add/"),exact:!0,render:function(e){return Object(c.jsx)(F,Object(o.a)(Object(o.a)({},e),{},{model:r}))}}),Object(c.jsx)(p.a,{path:k(this.props.match.path,"/:id(\\d+)/edit/"),exact:!0,render:function(e){return Object(c.jsx)(H,Object(o.a)(Object(o.a)({},e),{},{model:r}))}}),Object(c.jsxs)(p.a,{children:[Object(c.jsx)("p",{children:"404 Page Not Found."}),Object(c.jsx)("p",{children:"This page doesn't exist."})]})]})]})}}]),n}(s.Component),E=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={data:null},a.api_endpoint=a.props.model.endpoint,a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;new v(this.api_endpoint).getList().then((function(t){return e.setState({data:t.data})})).catch((function(e){return console.log(e)}))}},{key:"componentDidUpdate",value:function(e,t,n){}},{key:"render",value:function(){return this.state.data?Object(c.jsx)("div",{className:"content",children:Object(c.jsx)("div",{className:"table-container",children:Object(c.jsx)("div",{className:"table-outer",children:Object(c.jsx)(M,{data:this.state.data.results,tableCols:this.props.model.list_display,tableTh:this.props.model.list_display_labels,tableColCls:[],tableThWidths:[],tableRowURI:":id/edit/",tableRowActions:null,tableCheckable:!0,tableCheckCallback:function(){return null}})})})}):Object(c.jsx)("div",{className:"content",children:"Loading..."})}}]),n}(s.Component);function F(e){return Object(c.jsx)("h1",{children:"Add page"})}function H(e){return Object(c.jsx)("h1",{children:"Edit page"})}var q=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){return Object(d.a)(this,n),t.call(this,e)}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=this.props.match.params.app_label;if(!this.props.initData.apps.hasOwnProperty(t))return Object(c.jsx)(P,{location:this.props.location});var n=this.props.initData.apps[t];return Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(S,{hideSubnav:!0,title:n.verbose_name,location:this.props.location}),Object(c.jsx)("div",{className:"content",children:Object.keys(n.models).map((function(a){var s=n.models[a];return Object(c.jsx)("div",{children:Object(c.jsx)(u.b,{to:k(e.props.match.url,s.name),children:g(s.verbose_name_plural)})},t+"."+s.name)}))})]})}}]),n}(s.Component);function B(e){return Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(S,{title:"Home",hideSubnav:!0,location:e.location}),Object(c.jsx)("div",{className:"content"})]})}n(78);var J=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).getInitData=function(){new v("init").getList().then((function(e){a.setState({loading:!1,initData:e.data})})).catch((function(e){console.log(e),a.setState({loading:!1,errorMsg:"Something went wrong"})}))},a.state={loading:!0,initData:null,errorMsg:null},window.hasOwnProperty("candy")||(window.candy={site_name:"Candy"}),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getInitData()}},{key:"render",value:function(){var e=this;if(this.state.loading)return Object(c.jsx)("div",{children:"Loading..."});if(this.state.errorMsg)return Object(c.jsx)("div",{children:this.state.errorMsg});var t=[];for(var n in this.state.initData.apps){var a=this.state.initData.apps[n];for(var s in a.models){var i=a.models[s],r=k(i.app_label,i.name.toLowerCase());t.push(Object(c.jsx)(u.b,{to:r,children:g(i.verbose_name)}))}}return Object(c.jsxs)("div",{className:"container-fluid",children:[Object(c.jsx)(R,{sideMenu:this.state.initData.side_menu,topMenu:this.state.initData.top_menu}),Object(c.jsx)("div",{className:"row",children:Object(c.jsx)("div",{className:"col-md-10 offset-md-2 px-0",children:Object(c.jsxs)(p.c,{children:[Object(c.jsx)(p.a,{path:"/",exact:!0,render:function(e){return Object(c.jsx)(B,Object(o.a)({},e))}}),Object(c.jsx)(p.a,{path:"/:app_label/",exact:!0,render:function(t){return Object(c.jsx)(q,Object(o.a)(Object(o.a)({},t),{},{initData:e.state.initData}))}}),Object(c.jsx)(p.a,{path:"/:app_label/:model/",render:function(t){return Object(c.jsx)(W,Object(o.a)(Object(o.a)({},t),{},{initData:e.state.initData}))}})]})})})]})}}]),n}(s.Component),V=Object(p.f)(J);function G(e){var t=e.props;return Object(c.jsxs)(u.a,{children:[Object(c.jsx)(p.a,{path:"/",render:function(){return Object(c.jsx)(V,Object(o.a)({},t))}}),Object(c.jsxs)("div",{className:"footer",children:["version ","0.9.0"]})]})}var z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,80)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};l.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(G,{})}),document.getElementById("root")),z()}},[[79,1,2]]]);
//# sourceMappingURL=main.2a5da451.chunk.js.map